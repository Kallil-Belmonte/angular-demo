<app-loader *ngIf="loading"></app-loader>

<form data-component="register-form" [formGroup]="registerForm" (ngSubmit)="onSubmitRegisterForm()">
  <h1 class="page-title">Register</h1>

  <div class="form-group">
    <label for="first-name">First name</label>
    <input id="first-name" [ngClass]="{ 'form-control': true, 'is-invalid': registerForm.get('firstName').touched && registerForm.get('firstName').invalid }" type="text" formControlName="firstName" />

    <ng-template [ngIf]="registerForm.get('firstName').touched && registerForm.get('firstName').errors">
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': registerForm.get('firstName').errors.required }">First name is required</div>
    </ng-template>
  </div>

  <div class="form-group">
    <label for="last-name">Last name</label>
    <input id="last-name" [ngClass]="{ 'form-control': true, 'is-invalid': registerForm.get('lastName').touched && registerForm.get('lastName').invalid }" type="text" formControlName="lastName" />

    <ng-template [ngIf]="registerForm.get('lastName').touched && registerForm.get('lastName').errors">
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': registerForm.get('lastName').errors.required }">Last name is required</div>
    </ng-template>
  </div>

  <div class="form-group">
    <label for="email">E-mail</label>
    <input id="email" [ngClass]="{ 'form-control': true, 'is-invalid': registerForm.get('email').touched && registerForm.get('email').invalid }" type="text" formControlName="email" />

    <ng-template [ngIf]="registerForm.get('email').touched && registerForm.get('email').errors">
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': registerForm.get('email').errors.required }">E-mail is required</div>
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': registerForm.get('email').errors.email }">Invalid e-mail</div>
    </ng-template>

    <ng-template [ngIf]="registerFormFeedback.fieldsErrors.email.length > 0">
      <app-alert status="danger" [dismissible]="true" (dismissAlert)="onClearFormMessage(registerFormFeedback.fieldsErrors.email, i)" *ngFor="let errorMessage of registerFormFeedback.fieldsErrors.email; let i = index">
        {{ errorMessage }}
      </app-alert>
    </ng-template>
  </div>

  <div class="form-group">
    <label for="password">Password</label>
    <input id="password" [ngClass]="{ 'form-control': true, 'is-invalid': registerForm.get('password').touched && registerForm.get('password').invalid }" type="password" formControlName="password" />

    <ng-template [ngIf]="registerForm.get('password').touched && registerForm.get('password').errors">
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': registerForm.get('password').errors.required }">Password is required</div>
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': registerForm.get('password').errors.minlength }">Minimum 3 characters required</div>
    </ng-template>

    <ng-template [ngIf]="registerFormFeedback.fieldsErrors.password.length > 0">
      <app-alert status="danger" [dismissible]="true" (dismissAlert)="onClearFormMessage(registerFormFeedback.fieldsErrors.password, i)" *ngFor="let errorMessage of registerFormFeedback.fieldsErrors.password; let i = index">
        {{ errorMessage }}
      </app-alert>
    </ng-template>
  </div>

  <button class="btn btn-primary d-block mx-auto" type="submit" [disabled]="!registerForm.valid || registerForm.pristine">Submit</button>

  <div class="text-center">
    <hr class="mt-4" />
    Aleady have an account? <a [routerLink]="['/login']">Login</a>
  </div>
</form>

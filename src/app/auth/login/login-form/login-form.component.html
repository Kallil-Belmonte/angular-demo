<app-loader *ngIf="loader"></app-loader>

<form data-component="login-form" [formGroup]="loginForm" (ngSubmit)="onSubmitLoginForm()">
  <h1 class="page-title">Login</h1>

  <div class="form-group">
    <label for="email">E-mail</label>
    <input id="email" [ngClass]="{ 'form-control': true, 'is-invalid': loginForm.get('email').touched && loginForm.get('email').invalid }" type="email" formControlName="email" />
    <ng-template [ngIf]="loginForm.get('email').touched && loginForm.get('email').errors">
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': loginForm.get('email').errors.required }">E-mail is required</div>
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': loginForm.get('email').errors.email }">Invalid e-mail</div>
    </ng-template>

    <ng-template [ngIf]="loginErrors.email.length > 0">
      <app-alert status="danger" [dismissible]="true" (dismissAlert)="onClearLoginError(loginErrors.email, i)" *ngFor="let errorMessage of loginErrors.email; let i = index">{{ errorMessage }}</app-alert>
    </ng-template>
  </div>

  <div class="form-group">
    <label for="password">Password</label>
    <input id="password" [ngClass]="{ 'form-control': true, 'is-invalid': loginForm.get('password').touched && loginForm.get('password').invalid }" type="password" formControlName="password" />
    <ng-template [ngIf]="loginForm.get('password').touched && loginForm.get('password').errors">
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': loginForm.get('password').errors.required }">Password is required</div>
      <div [ngClass]="{ 'invalid-feedback': true, 'd-block': loginForm.get('password').errors.minlength }">Minimum 3 characters required</div>
    </ng-template>

    <ng-template [ngIf]="loginErrors.password.length > 0">
      <app-alert status="danger" [dismissible]="true" (dismissAlert)="onClearLoginError(loginErrors.password, i)" *ngFor="let errorMessage of loginErrors.password; let i = index">{{ errorMessage }}</app-alert>
    </ng-template>
  </div>

  <div class="form-group">
    <div class="pretty p-svg p-curve">
      <input type="checkbox" formControlName="keepLogged" />
      <div class="state p-primary">
        <svg class="svg svg-icon" viewBox="0 0 20 20"><path d="M7.629,14.566c0.125,0.125,0.291,0.188,0.456,0.188c0.164,0,0.329-0.062,0.456-0.188l8.219-8.221c0.252-0.252,0.252-0.659,0-0.911c-0.252-0.252-0.659-0.252-0.911,0l-7.764,7.763L4.152,9.267c-0.252-0.251-0.66-0.251-0.911,0c-0.252,0.252-0.252,0.66,0,0.911L7.629,14.566z" style="stroke: white; fill: white;"></path></svg>
        <label>Keep logged</label>
      </div>
    </div>
  </div>

  <button class="btn btn-primary d-block mx-auto" type="submit" [disabled]="!loginForm.valid || loginForm.pristine">Login</button>

  <div class="text-center">
    <hr class="mt-4" />
    Don't have an account? <a [routerLink]="['/register']">Register</a>
  </div>
</form>
